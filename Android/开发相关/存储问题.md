# 存储问题
- 权限：使用外部存储需要在Manifest申请存储权限
    - 6.0为危险权限。需要动态申请，申请时会弹Dialog提示。可申请外部存储的读写权限
    - 10.0取消外部写入权限：1、需要添加android:requestLegacyExternalStorage="true"才能访问外部存储中的非私有目录,该标记11.0或卸载后会被忽略。2、同时添加了外部私有目录，该目录属于应用私有目录，其他应用无法访问，删除应用时会跟随卸载(Manifest配置hasFragileUserData=ture可以避免删除)。3、取消了外部存储的写入权限，必须添加步骤1才可以兼容，同时私有外部存储不需要申请该权限。共享目录(媒体文件，文档)中对于自己的文件读写不需要申请权限，读取其他应用的文件需要申请外部存储读取权限。可以使用MediaStore和系统文件选择器SAF来进行这部分的工作
    - 11.0在10.0的基础上增加：1、需要添加android:preserveLegacyExternalStorage="true"才能访问外部存储权限的非私有目录，卸载后被忽略。2、外部存储读取权限由危险权限变为特殊权限，需要跳转系统Activity进行申请。
- 文件
    - 内部存储处于data/data/包名/路径下，该目录跟随卸载删除。使用Context.getFileDir()/getCacheDir()来访问files和cache，同时这里还存储了shared_prefs和databases数据
    - 外部私有目录处于Android/data/包名/路径下，该目录其他应用无法访问，跟随卸载删除。使用Context.getExternalFileDir()/getExternalCacheDir()来访问外部的files和cache
    - 外部共享目录：如共享媒体和共享文档。使用MediaStore和系统文件选择器SAF来读写自己的文件。如果要读取其他应用的文件需要显示申明外部存储读取权限
    - 分享文件给其他应用需要使用FileProvider
- 其他
    - 应用删除后重新安装，之前公共文件无法直接访问，需要申请外部读权限
    - Q版本之前使用File相关Api来操作文件，之后使用MediaStore/SAF