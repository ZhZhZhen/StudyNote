# 重入锁
- 对AQS的实现，实现了可重入和公平竞争
- 重入实现：tryAcquire()方法中判断ExclusiveOwnerThread是否为当前线程，是则修改state并加一计数，不是则修改通过cas修改state从0为1，成功则设置ExclusiveOwnerThread。tryRelease()则判断是否相同线程，相同则计数减一，计数为0时置空ExclusiveOwnerThread，并返回true(返回true使得阻塞队列的下一个节点被唤醒去竞争同步)。
- 公平实现：首先进入阻塞队列的肯定是按照队列顺序去竞争同步，不公平发生在“当队列中的第二个节点开始竞争同步状态，这时一个未在队列节点中的线程也来竞争，有可能通过第一次尝试获取同步状态”。而公平状态要求先申请的线程先获得，即队列中的节点应该先获得同步状态。实现方式通过在cas设置state之前增加了一个判断：判断头结点的下一个节点记录的线程是否为当前线程||或头结点下一个节点为空。(前一种情况说明当前线程在阻塞队列中，后一种情况说明阻塞队列没有人在竞争同步)